-##
-# Google universal analytics
-# Place the locals in the data/google.yaml file
-#
-# @usage
-# -# Google analytics
-# = codeBlender "google-analytics", "atom"
-#
-# Google AutoTrack
-# cleanUrlTracker       Ensures consistency in the URL paths that get reported to Google Analytics; avoiding the problem where separate rows in your pages reports actually point to the same page.
-# eventTracker          Enables declarative event tracking, via HTML attributes in the markup.
-# impressionTracker     Allows you to track when elements are visible within the viewport.
-# mediaQueryTracker     Enables tracking media query matching and media query changes.
-# outboundFormTracker   Automatically tracks form submits to external domains.
-# outboundLinkTracker   Automatically tracks link clicks to external domains.
-# pageVisibilityTracker Tracks page visibility state changes, which enables much more accurate session, session duration, and pageview metrics.
-# socialWidgetTracker   Automatically tracks user interactions with the official Facebook and Twitter widgets.
-# urlChangeTracker      Automatically tracks URL changes for single page applications.
-#
-# @param googleAnalytics    - String - Required - Analytics ID
-# @param googleAnalyticsURL - String - Required - Associated Domain
-#
-# @author   Ian Warner <ian.warner@drykiss.com>
-# @category atom
-##

-# Code
- code = data.google.analytics.code

-# Check for locale code
- code = ( code == "locale" ) ? t( :"google.analytics.code" ) : code

-# URL
- url = data.google.analytics.url

-# Analytics
:javascript

    -# Include code
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    -# AutoTrack - Clean URL tracker
    -# @see https://github.com/googleanalytics/autotrack/blob/master/docs/plugins/clean-url-tracker.md
    ga( 'require', 'cleanUrlTracker', {
        stripQuery          : false,
        queryDimensionIndex : 1,
        indexFilename       : 'index.html',
        trailingSlash       : 'remove'
    });

    -# AutoTrack - Event tracker
    -# @see https://github.com/googleanalytics/autotrack/blob/master/docs/plugins/clean-url-tracker.md
    ga( 'require', 'eventTracker' );
    ga( 'require', 'outboundLinkTracker' );
    ga( 'require', 'urlChangeTracker' );

    -# Pageview
    ga( 'create', '#{ code }', '#{ url }' );
    ga( 'send',   'pageview' );
